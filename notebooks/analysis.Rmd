---
title: "Exploration of USAPL Powerlifting Database Using R"
output: html_notebook
---
```{r}
library('tidyverse')
```

**1. Using the read_csv() function, read the datasets into your notebook.**
  - Comp_types = All USAPL competitions and their urls from USAPL website.
  - Usapl = Webscraped results from urls of USAPL competitions.
  - Us_states = List of 50 US States. 
  - Usapl_timed_out = Webscraped results from urls with timed out errors during Python webscraping. 
  - Usapl_list_index = Webscraped results from urls with "list index out of range" errors during Python webscraping.

```{r}
comp_types <- read_csv('../data/USAPL_competitions_new.csv', show_col_types = FALSE)
usapl <- read_csv('../data/usapl_newnew.csv', show_col_types = FALSE)
usapl_timedout <- read_csv('../data/usapl_timed_out.csv', show_col_types = FALSE)
usapl_listindex <- read_csv('../data/usapl_list_index.csv', show_col_types = FALSE)
us_states <- read.delim('../data/us_states', header = TRUE)
```

*Notate the number of results for each webscraped results:*
```{r}
nrow(usapl)
nrow(usapl_timedout)
nrow(usapl_listindex)
```


*Merge usapl webscraped results.* 
```{r}
usapl <- rbind(usapl, usapl_timedout, usapl_listindex)
nrow(usapl)
```

*Rename columns in comp_types DF to match column names in usapl DF.* 
```{r}
comp_types <- comp_types |> 
  rename(`Meet Date` = Date, `Meet Name` = Name, `Meet Location`= State)
```

**2. Compare usapl DataFrame to comp_types DataFrame. Make sure both DataFrames have the same information.**

Missing_data_usapl is the DataFrame with rows containing information from meets in usapl DF but not found in comp_types DF. 
```{r}
missing_data_usapl <- anti_join(usapl, comp_types, by = c("Meet Name", "Sanction Number"))

length(unique(missing_data_usapl$`Meet Name`))
print(unique(missing_data_usapl$`Meet Name`))
print(length(unique(missing_data_usapl$`Sanction Number`)))
print(unique(missing_data_usapl$`Sanction Number`))
```

**3. Do some exploratory data analysis.** 

*There were some errors retrieving data from some urls due to request being timed out. Check if usapl DF has these competitions' data:*
```{r}
usapl |> 
  filter(`Meet Name` == "California State Games") |> 
  distinct(`Meet Date`)
```

*How many unique meets are in usapl DataFrame?* 
Some Meet Names are repeated every year so it makes sense if there's more sanction numbers than meet names. Some meets also don't have sanction numbers. Need to create a Unique Identification Number later. 
```{r}
length(unique(usapl$`Sanction Number`))
print(length(unique(usapl$`Meet Name`)))
```

*How many unique meets are in comp_types DataFrame?* 
```{r}
nrow(comp_types)
```

**4. Compare the number of competitions listed under each meet type in USAPL results database (https://usapl.liftingdatabase.com/competitions-default?t=&s=).** 
There are nine meet types in USAPL Federation: International, IPF (International POwerlifting Federation), Local, NAPF (North American Powerlifting Federation), Pro Meet, Pro Series, Regional, and State. There are no International meets so it is not included in dataset. 

According to USAPL results database online, there should be: 
- IPF = 67
- Local = 2597
- NAPF = 4
- National = 124
- Pro Meet = 12
- Pro Series = 21
- Regional = 51
- State = 392
- Total = 3268

The total matches the number of observations in comp_types DF. 

**5. Data Cleaning**

*Convert Meet Date column in both DataFrames to Date type. Need to create a new column with Date type for usapl DF because some meets in Meet Date column contain a range of dates.* 
```{r}
comp_types <- comp_types |> 
  mutate(`Meet Date` = mdy(`Meet Date`))
str(comp_types$`Meet Date`)

usapl <- usapl |> 
  mutate(`Date Format` = mdy(substr(`Meet Date`, 1, 10)))
str(usapl$`Date Format`)
```

*Create Unique Identification column for both DataFrames.*


